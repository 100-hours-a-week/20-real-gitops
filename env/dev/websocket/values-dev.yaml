replicaCount: 1

image:
  repository: 982640051576.dkr.ecr.ap-northeast-2.amazonaws.com/ktb-ca-infra-registry
  tag: ysocket-dev
  pullPolicy: Always

imagePullSecrets:
- name: ecr-registry-secret

ingress:
  enabled: true
  hosts:
  - host: wsdev.kakaotech.com
    paths:
    - path: /
      pathType: Prefix
  annotations:
    nginx.ingress.kubernetes.io/proxy-read-timeout: "3600"
    nginx.ingress.kubernetes.io/proxy-send-timeout: "3600"
    nginx.ingress.kubernetes.io/proxy-connect-timeout: "3600"
    nginx.ingress.kubernetes.io/proxy-buffering: "off"
    nginx.ingress.kubernetes.io/affinity: "cookie"
    nginx.ingress.kubernetes.io/session-cookie-name: "websocket-session"
    nginx.ingress.kubernetes.io/session-cookie-max-age: "3600"
    nginx.ingress.kubernetes.io/session-cookie-expires: "3600"
    nginx.ingress.kubernetes.io/session-cookie-path: "/"
    nginx.ingress.kubernetes.io/enable-websocket: "true"
    nginx.ingress.kubernetes.io/connection-proxy-header: "keep-alive"
    nginx.ingress.kubernetes.io/proxy-http-version: "1.1"
    nginx.ingress.kubernetes.io/backend-protocol: "WS"
    nginx.ingress.kubernetes.io/configuration-snippet: |
      proxy_set_header Cookie $http_cookie;
#  tls:
#    - hosts:
#        - wsdev.kakaotech.com
#      secretName: <your-tls-secret>

service:
  type: ClusterIP
  port: 3002

websocket:
  podDisruptionBudget:
    enabled: true
    minAvailable: 1
    terminationGracePeriodSeconds: 30

autoscaling:
  enabled: false
  minReplicas: 1
  maxReplicas: 2
  targetCPUUtilizationPercentage: 80
  targetMemoryUtilizationPercentage: 80

resources:
  requests:
    cpu: 200m
    memory: 256Mi
  limits:
    cpu: 500m
    memory: 512Mi
